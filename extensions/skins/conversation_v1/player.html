<script type="text/ng-template" id="skins/Conversation">
  <link rel="stylesheet" type="text/css"
        href="/extensions/skins/conversation_v1/static/conversation.css">

  <div role="main" style="margin: 0 auto; max-width: 95%; position: relative;">
    <div class="conversation-skin-cards-container">

      <div style="margin: 20px auto;">
        <progress-dots num-dots="numProgressDots" current-dot-index="currentProgressDotIndex">
        </progress-dots>
      </div>

      <md-card class="conversation-skin-exploration-intro-card">
        <img ng-src="<[introCardImageUrl]>">
        <div class="conversation-skin-exploration-header">
          <h3 itemprop="description" role="heading" class="protractor-test-exploration-header"><[explorationTitle]></h3>
        </div>
      </md-card>

      <div class="conversation-skin-iframe-container">
        <oppia-gadget-panel panel-contents="gadgetPanelsContents.left" class="conversation-skin-left-gadget-panel"></oppia-gadget-panel>
        <oppia-gadget-panel panel-contents="gadgetPanelsContents.right" class="conversation-skin-right-gadget-panel"></oppia-gadget-panel>
        <div ng-repeat="state in allResponseStates track by $index"
             ng-class="{'conversation-skin-last-log-entry': $last}">
          <md-card class="conversation-skin-card">
            <div class="conversation-skin-card-feedback-toggle-container" ng-if="state.stateName && !isInPreviewMode">
              <span class="glyphicon glyphicon-comment conversation-skin-card-feedback-toggle" popover-placement="<[isWindowNarrow() ? 'left' : 'bottom']>" popover-template="popover/feedback" popover-trigger="click" tooltip="Feedback" tooltip-placement="bottom" state-name="<[state.stateName]>">
              </span>
            </div>

            <table class="conversation-skin-card-row-container">
              <tr class="conversation-skin-card-row">
                <td class="conversation-skin-row-avatar" valign="top">
                  <img class="conversation-skin-row-avatar-img" src="/images/general/oppia_black_48px.png">
                </td>
                <td class="conversation-skin-oppia-output conversation-skin-oppia-content">
                  <div class="protractor-test-conversation-content" angular-html-bind="state.content"></div>
                </td>
              </tr>
            </table>

            <div ng-repeat="responsePair in state.answerFeedbackPairs track by $index">
              <table class="conversation-skin-card-row-container">
                <tr ng-show="responsePair.learnerAnswer" class="conversation-skin-card-row">
                  <td class="conversation-skin-row-avatar" valign="top">
                    <img class="conversation-skin-row-avatar-img img-circle" ng-src="<[profilePicture]>">
                  </td>
                  <td class="conversation-skin-learner-answer" angular-html-bind="responsePair.learnerAnswer"></td>
                </tr>
              </table>
              <table ng-show="responsePair.oppiaFeedback" class="conversation-skin-card-row-container">
                <tr class="conversation-skin-card-row">
                  <td class="conversation-skin-row-avatar" valign="top">
                    <img class="conversation-skin-row-avatar-img" src="/images/general/oppia_black_48px.png">
                  </td>
                  <td class="conversation-skin-oppia-output conversation-skin-oppia-feedback protractor-test-conversation-feedback" angular-html-bind="responsePair.oppiaFeedback"></td>
                </tr>
              </table>
            </div>

            <div ng-if="$last" ng-show="waitingForOppiaFeedback">
              <div class="conversation-skin-loading-dots">
                <div class="oppia-loading-dot-one"></div>
                <div class="oppia-loading-dot-two"></div>
                <div class="oppia-loading-dot-three"></div>
              </div>
            </div>

            <div ng-if="stateName && !waitingForNewCard && !waitingForOppiaFeedback && interactionIsInline && $last">
              <div class="conversation-skin-inline-interaction">
                <table class="conversation-skin-card-row-container" style="margin-bottom: 0;">
                  <tr class="conversation-skin-card-row">
                    <td class="conversation-skin-row-avatar" valign="top">
                      <img class="conversation-skin-row-avatar-img img-circle" ng-src="<[profilePicture]>">
                    </td>
                    <td class="conversation-skin-learner-input protractor-test-conversation-input"
                        angular-html-bind="inputTemplate">
                    </td>
                  </tr>
                </table>
              </div>
            </div>
          </md-card>
        </div>
      </div>

      <div ng-if="waitingForNewCard">
        <div class="conversation-skin-loading-dots">
          <div class="oppia-loading-dot-one"></div>
          <div class="oppia-loading-dot-two"></div>
          <div class="oppia-loading-dot-three"></div>
        </div>
      </div>

      <div class="conversation-skin-supplemental-interaction">
        <div ng-if="!waitingForNewCard && !interactionIsInline && inputTemplate && (!finished || !isIframed)">
          <md-card class="conversation-skin-supplemental-card">
            <div class="protractor-test-conversation-input" angular-html-bind="inputTemplate">
            </div>
          </md-card>
        </div>
      </div>

      <div ng-if="!waitingForNewCard && finished && isLoggedIn && !isInPreviewMode && !isIframed" class="conversation-skin-final-ratings">
        <oppia-gadget-panel panel-contents="gadgetPanelsContents.bottom"></oppia-gadget-panel>
        <div style="margin-bottom: 20px;">Learned something new? How would you rate this exploration?</div>
        <div popover-placement="bottom" popover-template="popover/feedback" popover-trigger="click">
          <rating-from-value rating-value="userRating" is-editable="true" on-edit="submitUserRating" style="letter-spacing: 10px;">
          </rating-from-value>
        </div>
      </div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="components/progressDots">
  <style>
    @keyframes oppia-animate-enter-progress-dot {
      0% {
        margin-left: -15px;
      }

      10% {
        margin-left: -13px;
      }

      70% {
        margin-left: -2px;
      }

      100% {
        margin-left: 0;
      }
    }

    .oppia-progress-dot {
      border-radius: 50%;
      width: 10px;
      height: 10px;
      float: left;
      margin-left: 5px;
    }
    .oppia-progress-dot-active {
      background-color: blue;
    }
    .oppia-progress-dot-inactive {
      background-color: #ccc;
      cursor: pointer;
    }

    .oppia-animate-progress-dot.ng-enter {
      -webkit-animation: 0.3s oppia-animate-enter-progress-dot;
      animation: 0.3s oppia-animate-enter-progress-dot;
    }
  </style>

  <div style="width: 300px; margin: 10px auto;">
    <ul style="list-style-type: none; padding-left: 0; text-align: center; margin: 10px auto; position: relative;">
      <li ng-repeat="dot in dots track by $index" style="display: inline-block;" class="oppia-animate-progress-dot">
        <span class="oppia-progress-dot oppia-progress-dot-active" ng-if="$index === currentDotIndex"></span>
        <span class="oppia-progress-dot oppia-progress-dot-inactive" ng-if="$index !== currentDotIndex" ng-click="changeActiveDot($index)"></span>
      </li>
    </ul>
  </div>
</script>
