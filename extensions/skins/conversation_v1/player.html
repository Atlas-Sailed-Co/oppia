<script type="text/ng-template" id="skins/Conversation">
  <link rel="stylesheet" type="text/css"
        href="/extensions/skins/conversation_v1/static/conversation.css">

  <!-- TODO(sll): do we need to preserve the itemprop attr? -->

  <div role="main" style="margin: 0 auto; position: relative;">
    <md-card class="conversation-skin-card">
      <div class="conversation-skin-card-feedback-toggle-container" ng-if="activeCard.stateName && !isInPreviewMode">
        <span class="glyphicon glyphicon-comment conversation-skin-card-feedback-toggle" popover-placement="<[isWindowNarrow() ? 'left' : 'bottom']>" popover-template="popover/feedback" popover-trigger="click" tooltip="Feedback" tooltip-placement="bottom" state-name="<[activeCard.stateName]>">
        </span>
      </div>

      <div class="conversation-skin-card-top">
        <div>
          <img class="conversation-skin-initial-oppia-avatar" src="/images/general/oppia_black_48px.png">
          <div class="protractor-test-conversation-content" angular-html-bind="activeCard.content">
          </div>
        </div>
      </div>

      <div ng-repeat="responsePair in activeCard.answerFeedbackPairs track by $index">
        <div class="conversation-skin-learner-answer-container">
          <img class="conversation-skin-user-avatar" ng-src="<[profilePicture]>" style="top: -5px;">
          <div class="conversation-skin-learner-answer" angular-html-bind="responsePair.learnerAnswer">
          </div>
        </div>

        <div class="conversation-skin-oppia-feedback-container">
          <img class="conversation-skin-oppia-avatar img-circle" ng-src="/images/general/oppia_black_48px.png" style="top: 0;">
          <div class="conversation-skin-oppia-feedback protractor-test-conversation-feedback" angular-html-bind="responsePair.oppiaFeedback">
          </div>
        </div>

        <div ng-if="$last" ng-show="waitingForOppiaFeedback">
          <div class="conversation-skin-loading-dots">
            <div class="oppia-loading-dot-one"></div>
            <div class="oppia-loading-dot-two"></div>
            <div class="oppia-loading-dot-three"></div>
          </div>
        </div>
      </div>

      <div ng-if="stateName && !waitingForNewCard && !waitingForOppiaFeedback && interactionIsInline">
        <div class="conversation-skin-inline-interaction">
          <img class="conversation-skin-user-avatar img-circle" ng-src="<[profilePicture]>">
          <div class="conversation-skin-user-input protractor-test-conversation-input" angular-html-bind="inputTemplate">
          </div>
        </div>
      </div>
    </md-card>
  </div>

  <div ng-if="waitingForNewCard">
    <div class="conversation-skin-loading-dots">
      <div class="oppia-loading-dot-one"></div>
      <div class="oppia-loading-dot-two"></div>
      <div class="oppia-loading-dot-three"></div>
    </div>
  </div>

  <div class="conversation-skin-supplemental-interaction">
    <div ng-if="!waitingForNewCard && !interactionIsInline && inputTemplate && (!finished || !isIframed)">
      <md-card class="conversation-skin-supplemental-card">
        <div class="protractor-test-conversation-input" angular-html-bind="inputTemplate">
        </div>
      </md-card>
    </div>
  </div>

  <div ng-if="!waitingForNewCard && finished && isLoggedIn && !isInPreviewMode && !isIframed" class="conversation-skin-final-ratings">
    <oppia-gadget-panel panel-contents="gadgetPanelsContents.main" class="conversation-skin-main-gadget-panel"></oppia-gadget-panel>

    <div style="margin-bottom: 20px;">Learned something new? How would you rate this exploration?</div>
    <div popover-placement="bottom" popover-template="popover/feedback" popover-trigger="click">
      <rating-from-value rating-value="userRating" is-editable="true" on-edit="submitUserRating" style="letter-spacing: 10px;">
      </rating-from-value>
    </div>
  </div>
</script>
